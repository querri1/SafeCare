<navigation-bar title="" back="{{true}}" color="black" background="#FFF"></navigation-bar>

<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- æ—¶é—´ç­›é€‰ -->
    <view class="filter-section">
      <view class="filter-card">
        <view class="filter-header">
          <text class="filter-title">æ—¶é—´ç­›é€‰</text>
          <text class="filter-count">å…± {{totalCount}} æ¡è®°å½•</text>
        </view>
        <view class="filter-buttons">
          <button 
            class="filter-btn {{timeRange === '7days' ? 'active' : ''}}" 
            bindtap="switchTimeRange" 
            data-range="7days"
          >
            è¿‘7å¤©
          </button>
          <button 
            class="filter-btn {{timeRange === '30days' ? 'active' : ''}}" 
            bindtap="switchTimeRange" 
            data-range="30days"
          >
            è¿‘30å¤©
          </button>
          <button 
            class="filter-btn {{timeRange === 'all' ? 'active' : ''}}" 
            bindtap="switchTimeRange" 
            data-range="all"
          >
            å…¨éƒ¨
          </button>
        </view>
      </view>
    </view>

    <!-- è®°å½•åˆ—è¡¨ -->
    <view class="records-section" wx:if="{{groupedRecords.length > 0}}">
      <view class="date-group" wx:for="{{groupedRecords}}" wx:key="date">
        <view class="date-header">
          <text class="date-icon">ğŸ“…</text>
          <text class="date-text">{{item.date}}</text>
          <text class="date-count">{{item.records.length}} æ¡</text>
        </view>
        
        <view class="records-list">
          <view 
            class="record-card" 
            wx:for="{{item.records}}" 
            wx:key="_id"
            wx:for-item="record"
            bindtap="viewRecordDetail"
            data-record="{{record}}"
          >
            <view class="record-icon-wrapper">
              <view class="record-icon {{record.type === 'PHQ-9' ? 'phq9' : 'gad7'}}">
                <image 
                  class="icon-img" 
                  src="../../images/{{record.type === 'PHQ-9' ? 'icon-brain.png' : 'icon-heart.png'}}"
                ></image>
              </view>
            </view>
            
            <view class="record-content">
              <view class="record-header">
                <text class="record-type">{{record.typeName}}</text>
                <view class="record-score-badge">
                  <text class="score-label">å¾—åˆ†</text>
                  <text class="score-value">{{record.score}}</text>
                </view>
              </view>
              
              <text class="record-severity">{{record.severity}}</text>
              
              <view class="record-time">
                <text class="time-icon">ğŸ•</text>
                <text class="time-text">{{record.time}}</text>
              </view>
            </view>
            
            <view class="record-arrow">
              <text class="arrow">â€º</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <view class="empty-icon">ğŸ“‹</view>
      <text class="empty-title">æš‚æ— æµ‹è¯•è®°å½•</text>
      <text class="empty-desc">å®Œæˆå¿ƒç†å¥åº·æµ‹è¯•åï¼Œè®°å½•ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
    </view>
  </view>
</scroll-view>

